# Only apply on macOS
if [ "$(uname)" = "Darwin" ]; then
  # Find the latest Ansible version by sorting and taking the last entry
  ANSIBLE_COLLECTIONS=$(find /opt/homebrew/Cellar/ansible -type d -path "*/site-packages/ansible_collections" 2>/dev/null | sort -V | tail -n 1)
  
  if [ -n "$ANSIBLE_COLLECTIONS" ]; then
    export ANSIBLE_COLLECTIONS_PATH="$ANSIBLE_COLLECTIONS:/Users/$(whoami)/.ansible/collections:/usr/share/ansible/collections"
    echo "Ansible collections path set to: $ANSIBLE_COLLECTIONS_PATH"
  else
    echo "Warning: Could not find Ansible collections path"
  fi
fi